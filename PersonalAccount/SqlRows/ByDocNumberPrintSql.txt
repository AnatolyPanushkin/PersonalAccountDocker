SELECT operation_id,
       type,
       to_char((((time at time zone(operation_time_timezone)::TEXT))::TIMESTAMP::TEXT)::TIMESTAMP,'DD.MM.YYYY HH:MI:SS')
       		|| CASE WHEN operation_time_timezone::TEXT = '0' THEN '+' ELSE '' END
       		|| (translate(operation_time_timezone::TEXT,'+-','-+')::TEXT) AS time,
       case when airline_code='{0}' then place else null end place,
       case when airline_code='{0}' then sender else null end sender,
       transaction_time,
       validation_status,
       operation_time_timezone,
       passenger_id,
       surname,
       name,
       patronymic,
       birthdate,
       gender_id,
       passenger_document_id,
       passenger_document_type,
       passenger_document_number,
       passenger_document_disabled_number,
       passenger_document_large_number,
       passenger_type_id,
       passenger_type_name,
       passenger_type_type,
       ra_category,
       description,
       is_quota,
       ticket_id,
       depart_datetime_timezone,
       case when airline_code='{0}' then ticket_number ELSE '*******'||SUBSTR(ticket_number,8,6)  end ticket_number,
       ticket_type,
       airline_route_id,
       case when airline_code='{0}' then airline_code else null end airline_code,
       case when airline_code='{0}' then depart_place else null end depart_place,
       to_char((((depart_datetime at time zone(depart_datetime_timezone)::TEXT))::TIMESTAMP::TEXT)::TIMESTAMP,'DD.MM.YYYY HH:MI:SS')
       		|| CASE WHEN depart_datetime_timezone::TEXT = '0' THEN '+' ELSE '' END
       		|| (translate(depart_datetime_timezone::TEXT,'+-','-+')::TEXT) AS depart_datetime,
       case WHEN airline_code='{0}' then arrive_place else null end arrive_place,
       case when airline_code='{0}' then to_char((((arrive_datetime at time zone(arrive_datetime_timezone)::TEXT))::TIMESTAMP::TEXT)::TIMESTAMP,'DD.MM.YYYY HH:MI:SS')
       		|| CASE WHEN arrive_datetime_timezone::TEXT = '0' THEN '+' ELSE '' END
       		|| (translate(arrive_datetime_timezone::TEXT,'+-','-+')::TEXT)  else null end arrive_datetime, 
       case when airline_code='{0}' then pnr_id else null end pnr_id,
       case when airline_code='{0}' then operating_airline_code else null end operating_airline_code,
       case when airline_code='{0}' then arrive_datetime_timezone else null end arrive_datetime_timezone,
       case when airline_code='{0}' then city_from_code else null end city_from_code,
       case when airline_code='{0}' then city_from_name else null end city_from_name,
       case when airline_code='{0}' then airport_from_icao_code else null end airport_from_icao_code,
       case when airline_code='{0}' then airport_from_rf_code else null end airport_from_rf_code,
       case when airline_code='{0}' then airport_from_name else null end airport_from_name,
       case when airline_code='{0}' then city_to_code else null end city_to_code,
       case WHEN airline_code='{0}' then city_to_name else null end city_to_name,
       case when airline_code='{0}' then airport_to_icao_code else null end airport_to_icao_code,
       case when airline_code='{0}' then airport_to_rf_code else null end airport_to_rf_code,
       case when airline_code='{0}' then airport_to_name else null end airport_to_name,
       case when airline_code='{0}' then flight_nums else null end flight_nums,
       case when airline_code='{0}' then fare_code else null end fare_code,
       case when airline_code='{0}' then fare_price else null end fare_price
FROM data_all WHERE passenger_document_number = '{1}'